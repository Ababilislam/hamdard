{{extend 'layout.html'}}
  

<script src="{{=URL('static','js_and_css/jquery-1.8.2.js')}}"></script>
<script src="{{=URL('static','js_and_css/jquery-ui.js')}}"></script>
<script src="{{=URL('static','js/bootstrap-multiselect.js')}}"></script>
<script src="{{=URL('static','js/bootstrap.min.js')}}"></script>

<script> 

var base_url=location.protocol + "//" + location.hostname + (location.port && ":" + location.port) + "/{{=request.application}}/";

$(function() {
  var SelectItemIDName="";
   // alert(base_url+'target/get_active_item_id_name')
  $.ajax({

    url: base_url+'target/get_active_item_id_name',
    success: function(targetItem) {
      SelectItemIDName = targetItem
    }
  });



  $('#clean_product').keyup(function(){
    // alert('ok')
    //-------------------------
    var ref_list = SelectItemIDName.split(',');  
    var ref_name=$("#clean_product").val();
    // alert(ref_name)
    
    //---------------- auto complete combo list
    var ref_list_new=new Array();
    lc=0;
    i =0;
    var refStr="";        
    while (i < ref_list.length)
    {
      refStr=ref_list[i];
      i=i+1;          
      var res=refStr.toUpperCase().match(ref_name.toUpperCase());
      if (res!=null){
        ref_list_new[lc]=refStr;
        lc=lc+1;
        if (lc==30){
          break;
        };
      }else{
        continue;
      }         
    };
    
    //-------------- auto complete source
    $( "input#clean_product" ).autocomplete({
      source: ref_list_new
    });

  }); 

  // =============================================================================================
       
  }); 

</script> 

  
  <table width="100%"  border="0" cellspacing="0" cellpadding="0" style="background-color:#FFFFFF;" >
  <tr height="30px" >
    <td width="800"><span class="blackCatTitle">Target Route Item - Batch Upload</span></td>
	<form action="{{=URL(c='target',f='target_add_route_item')}}" method="post">
	<td align="left">	
	<input name="" type="submit"  value="Back"/>	
	</td>
	</form>
  </tr>
  <tr  height="1px" style="background-color:#CCCCCC;">
	    <td width="800" ></td>
		<td ></td>
  </tr>
  </table>
  
  
  <table width="100%" height="500px"  border="0" cellspacing="0" cellpadding="0" class="page_color"  >
  <tr height="100%"  style="vertical-align:top;">
    <td>
	<table width="100%"  border="0" cellpadding="0" cellspacing="0"  >
      <tr>
        <td width="5">&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td width="5">&nbsp;</td>
        <td>
		<!--start-->


<table width="750" border="0" cellpadding="0" cellspacing="0" class="page_color">
  <tr>
    <td colspan="2" bgcolor="#DBF0EF">
      <div align="left" class="blackCat"> 
	  &nbsp;Download this <a href="{{=URL('static','target_upload_format_route_item.xls')}}">Excel Template</a> , fillup with data and copy (maximum 1000 records)-paste bellow to upload </div>
	  
	
	</td>
  </tr>

  <tr>
    <td colspan="2"  bgcolor="#C8E8EA" align="center"> <div align="left"><br/>
    </td>
  </tr>

  <form name="batch_route" id="batch_route" method="post" action="{{=URL(c='target',f='target_batch_upload_route_item')}}">
  
    <tr>
      <td colspan="2" bgcolor="#DBF0EF">
	  <textarea name="excel_data" id="excel_data" style="width:800px; height:200px;border-style:solid" ></textarea>
	  </td>
    </tr>
    <tr>		
      <td width="697" bgcolor="#DBF0EF">&nbsp;</td>  
	  
      <td width="61" align="left" bgcolor="#DBF0EF">
	    <input type="submit" name="btn_upload" id="btn_upload" value="Upload" />
		</td>
    </tr>
	</form>
	<tr>
      <td colspan="2" bgcolor="#DBF0EF">&nbsp;</td>
	<tr>
      <td colspan="2" bgcolor="#DBF0EF">
	  &nbsp;Total Record:{{=total_row}}<br/>
	  &nbsp;Record Saved:{{=count_inserted}}<br/>
	  &nbsp;Record Error:{{=count_error}}
	  </td>
    </tr>
    <tr>
      <td colspan="2" bgcolor="#DBF0EF"><div align="left">&nbsp;Error Details:</div></td>
    </tr>
    <tr>
      <td colspan="2" bgcolor="#DBF0EF"> 
        <textarea type="textarea" name="error_data" id="error_data" style="width:800px; height:200px; border-style:solid;font-size:12px">{{=error_str}}</textarea>
      </td>
    </tr>  
  <tr>
  <td colspan="2">&nbsp;</td>
  </tr>
</table>
<br/>
<table>
    <tr>
    	<td >Target Clean</td>
    </tr>
    <form id="form1" name="form1" method="post" action="{{=URL(c='target',f='target_batch_upload_route_item')}}">
    <tr>
    	<td >        	
              <select id="clean_year" name="clean_year" style="width:122px;" >
                <option value="">Year</option>
                {{for i in range(2021,2030):}}
                    <option value="{{=i}}">{{=i}}</option>
                {{pass}}		
              </select>
                -
                <select id="clean_month" name="clean_month" style="width:128px;" >
                    <option value="">Month</option>
                    <option value="01">Jan</option>
                    <option value="02">Feb</option>
                    <option value="03">Mar</option>
                    <option value="04">Apr</option>
                    <option value="05">May</option>
                    <option value="06">Jun</option>
                    <option value="07">Jul</option>
                    <option value="08">Aug</option>
                    <option value="09">Sep</option>
                    <option value="10">Oct</option>
                    <option value="11">Nov</option>
                    <option value="12">Dec</option>
                </select>
        	
            <input type="text" id="clean_route" name="clean_route" placeholder="Route"  />
            <input type="submit" name="btn_clean" id="btn_clean" value="Clean"   class="button_update" style="height:25px;margin-bottom: 10px;" />
        </td>
    </tr>
    <tr>
      <td >         
              <select id="clean_year_product" name="clean_year_product" style="width:122px;" >
                <option value="">Year</option>
                {{for i in range(2021,2030):}}
                    <option value="{{=i}}">{{=i}}</option>
                {{pass}}    
              </select>
                -
                <select id="clean_month_product" name="clean_month_product" style="width:128px;" >
                    <option value="">Month</option>
                    <option value="01">Jan</option>
                    <option value="02">Feb</option>
                    <option value="03">Mar</option>
                    <option value="04">Apr</option>
                    <option value="05">May</option>
                    <option value="06">Jun</option>
                    <option value="07">Jul</option>
                    <option value="08">Aug</option>
                    <option value="09">Sep</option>
                    <option value="10">Oct</option>
                    <option value="11">Nov</option>
                    <option value="12">Dec</option>
                </select>
          
            <input type="text" id="clean_product" name="clean_product" placeholder="Product"  required />
            <input type="submit" name="btn_clean_product" id="btn_clean_product" value="Clean Product" class="button_update" style="height:25px;margin-bottom: 10px;" />
        </td>
    </tr>
    </form>
</table>

	</td>
  </tr>
</table>
	<!--end-->
	</td>
  </tr>
</table>

